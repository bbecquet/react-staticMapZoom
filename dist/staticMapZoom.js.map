{"version":3,"sources":["../src/staticMapZoom.jsx"],"names":[],"mappings":"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","file":"staticMapZoom.js","sourcesContent":["import React, { PropTypes } from 'react';\nimport providers from './mapProviders.js';\n\nexport default class StaticMapZoom extends React.Component {\n    static propTypes = {\n        center: PropTypes.array.isRequired,\n        zooms: PropTypes.array.isRequired,\n        href: PropTypes.string,\n        provider: PropTypes.string,\n        reticle: PropTypes.bool,\n        height: PropTypes.number,\n        width: PropTypes.number\n    };\n\n    static defaultProps = {\n        href: null,\n        provider: 'google',\n        reticle: false,\n        height: 250,\n        width: 500\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            visiblePane: 0\n        };\n    }\n\n    componentDidMount() {\n        this.installMouseBehavior();\n    }\n\n    componentWillUnmount() {\n    }\n\n    // TODO: move it to providers (?)\n    buildImageUrls() {\n        return this.props.zooms.map((zoom) => {\n            const opts = {\n                w: this.props.width,\n                h: this.props.height,\n                lat: this.props.center[0],\n                lng: this.props.center[1],\n                z: zoom,\n                key: '[your_key_here]'\n            };\n            return providers[this.props.provider](opts);\n        });\n    }\n\n    installMouseBehavior() {\n        const {\n            height,\n            width,\n            zooms\n        } = this.props;\n\n        // computes coordinates of zones reacting to mouse events (i.e. the \"pyramid\" to the center)\n        const nbLevels = zooms.length - 1;\n        const hSteps = (width / 2) / nbLevels;\n        const vSteps = (height / 2) / nbLevels;\n\n        // levels disappear one by one as the mouse moves closer to the center\n        this.wrapperElement.addEventListener('mousemove', e => {\n            // find the relative coordinates of the mouse in the widget\n            let relX = e.clientX - this.wrapperElement.offsetLeft;\n            let relY = e.clientY - this.wrapperElement.offsetTop;\n            // normalize values so that only the first quadrant has to be tested\n            if (relX > width / 2) {\n                relX = width - relX;\n            }\n            if (relY > height / 2) {\n                relY = height - relY;\n            }\n            // find the zoom, by finding the inner-most zone the cursor is in\n            const pane = Math.min(Math.floor(relX / hSteps), Math.floor(relY / vSteps)) + 1;\n            this.setState({ visiblePane: pane });\n        });\n        // the first level will disappear as soon as the mouse enters the element,\n        // make it reappear when it leaves\n        this.wrapperElement.addEventListener('mouseout', e => {\n            this.setState({ visiblePane: 0 });\n        });\n    }\n\n    render() {\n        const imgUrls = this.buildImageUrls();\n        imgUrls.reverse();\n        const panes = imgUrls.map((url, i) =>\n            <div\n                key={i}\n                className=\"staticMapZoom-zoomPane\"\n                style={{\n                    position: 'absolute',\n                    width: '100%',\n                    height: '100%',\n                    transition: 'opacity 0.2s ease',\n                    backgroundSize: '100%',\n                    backgroundImage: `url(${url})`,\n                    // zIndex: `${imgUrls.length - i}`,\n                    opacity: (i > this.state.visiblePane) ? 0 : 1\n                }}\n            />\n        );\n        const classes = `staticMapZoom ${this.props.reticle ? 'staticMapZoom-reticle' : ''}`;\n\n        if (this.props.href) {\n            return <a href={this.props.href}\n                className={classes}\n                ref={(ref) => {this.wrapperElement = ref;}}\n                style={{\n                    height: `${this.props.height}px`,\n                    width: `${this.props.width}px`\n                }}\n            >\n                { panes }\n            </a>;\n        }\n\n        return <div\n            className={classes}\n            ref={(ref) => {this.wrapperElement = ref;}}\n            style={{\n                height: `${this.props.height}px`,\n                width: `${this.props.width}px`\n            }}\n        >\n            { panes }\n        </div>;\n    }\n}\n"]}